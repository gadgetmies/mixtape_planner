{"version":3,"sources":["lib/graphWalk.js","lib/promiseHelpers.js","Tracklist.js","Planner.js","lib/parseTracklist.js","test/tracklist.js","lib/pathToTSV.js","TracklistInstructions.js","lib/pitchClassToCamelotKeyNumber.js","test/playlist.js","Visualizer.js","App.js","reportWebVitals.js","index.js","lib/keys.js","lib/arrayHelppers.js","lib/penalties.js"],"names":["graphWalk","a","tracks","intro","outro","targetLength","penalties","tolerance","maxTempoDifference","seed","filterByPenalty","timeout","console","log","minAndMaxValuesForPenalties","Object","fromEntries","keys","map","key","values","R","limits","penaltyLookup","_","ps","min","max","weight","normalize","i","fn","calculatePenalty","level","track","mapped","name","penaltyObj","penaltyFn","properties","calculateTempoDifference","t1","t2","normalDiff","Math","abs","tempo","scaledDiff","routes","bestRoute","path","penalty","Infinity","iterate","node","tracksLeft","Promise","accept","setImmediate","currentLength","currentPenalty","atTargetLength","undefined","suitableTracks","findSuitableTracksByKey","filter","t","currentNode","push","previous","reversedPath","splice","keyDistance","length","index","round","graphStart","Date","now","promiseOrTimeout","sort","seedrandom","graphTime","timeoutId","race","setTimeout","result","clearTimeout","useStyles","makeStyles","root","width","container","maxHeight","Tracklist","editing","selectedTrackIndex","onTrackSelected","classes","Paper","className","TableContainer","Table","stickyHeader","size","TableHead","TableRow","TableCell","propertyName","replace","toUpperCase","TableBody","Radio","checked","onChange","artist","title","parseInt","getKeyString","keyNumber","isMinor","property","oauth","spotify","parseTracklist","list","rows","trim","split","l","headers","validRows","r","assert","toLowerCase","propertyNames","slice","propertyValues","value","match","e","error","tracklist","pathToTSV","header","join","TracklistInstructions","props","Accordion","AccordionSummary","expandIcon","color","aria-label","aria-controls","id","AccordionDetails","Typography","href","children","pitchClassToCamelotKeyNumber","firstProperty","entries","firstPropertyValue","getTargetValues","truncateTitle","input","substring","theme","formControl","margin","spacing","buttonRow","display","Planner","useState","setTracklist","parsePlaylist","setTracks","paths","setPaths","defaultTracklist","selectedPath","setSelectedPath","setTargetLength","setTolerance","setMaxTempoDifference","processing","setProcessing","editingPlaylist","setEditingPlaylist","editingIntro","setEditingIntro","editingOutro","setEditingOutro","setIntro","setOutro","parametersChanged","setParametersChanged","setSeed","showAdvancedOptions","setShowAdvancedOptions","targetValues","setTargetValues","processingMessage","setProcessingMessage","editingSelectedTracklistResult","setEditingSelectedTracklistResult","selectedTracklist","setSelectedTracklist","parameterRange","targetFunctions","raisingSaw","saw","absoluteSine","targetFn","setTargetFunction","cachedTargetValues","setCachedTargetValues","React","playlistDialogOpen","setPlaylistDialogOpen","selectedSpotifyPlaylist","setSelectedSpotifyPlaylist","spotifyPlaylistItems","setSpotifyPlaylistItems","importingSpotifyPlaylist","setImportingSpotifyPlaylist","initializeAndOpenSpotifyPlaylistDialog","accessToken","SpotifyWebApi","setAccessToken","token","getUserPlaylists","playlists","items","useEffect","OAuth2AuthCodePKCE","authorizationUrl","tokenUrl","clientId","scopes","redirectUrl","process","onAccessTokenExpiry","refreshAccessToken","onInvalidGrant","refreshAuthCodeOrRefreshToken","isReturningFromAuthServer","then","hasAuthCode","getAccessToken","catch","potentialError","handlePlaylistDialogClose","handlePlaylistSelected","getPlaylist","playlist","tracksFromPlaylist","artists","popularity","getAudioFeaturesForTracks","features","parsedPlaylist","Energy","energy","audio_features","Container","maxWidth","Button","variant","disabled","onClick","fetchAuthorizationCode","find","Dialog","disableBackdropClick","disableEscapeKeyDown","open","onClose","DialogTitle","DialogContent","FormControl","InputLabel","Select","labelId","event","target","Input","MenuItem","DialogActions","findIndex","style","TextField","fullWidth","rowsMax","multiline","onKeyDown","preventDefault","textArea","start","selectionStart","end","selectionEnd","Slider","valueLabelDisplay","marginTop","tf","marginBottom","label","toString","options","chart","xaxis","categories","series","data","height","FormControlLabel","control","Switch","step","Number","random","document","getElementById","scrollIntoView","behavior","block","CircularProgress","minHeight","ButtonGroup","newLength","pathItem","yaxis","labels","formatter","val","floor","truncate","Visualizer","useUrlSearchParams","params","setParams","indexOf","parsedTracklist","setParsedTracklist","shortenUrl","tinyurl","shorten","window","location","TwitterShareButton","url","TwitterIcon","padding","FacebookShareButton","FacebookIcon","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","isSuitableKey","useConservativeKeyTransitions","current","newMin","newMax","range","oldMin","oldMax","oldValue","ref","riseTime","n","pos","sin"],"mappings":"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","file":"static/js/main.35c67053.chunk.js","sourcesContent":["import * as R from 'ramda'\n\nimport { limits, normalize } from './arrayHelppers'\nimport { findSuitableTracksByKey, keyDistance } from './keys'\nimport { promiseOrTimeout } from './promiseHelpers'\nimport { penaltyFn } from './penalties'\nimport * as seedrandom from 'seedrandom'\n\nexport const graphWalk = async ({\n  tracks,\n  intro,\n  outro,\n  targetLength,\n  penalties,\n  tolerance,\n  maxTempoDifference,\n  seed,\n  filterByPenalty = true,\n  timeout = 0.5,\n}) => {\n  console.log({\n    tracks,\n    intro,\n    outro,\n    targetLength,\n    penalties,\n    tolerance,\n    maxTempoDifference,\n    seed,\n    filterByPenalty,\n    timeout,\n  })\n  const minAndMaxValuesForPenalties = Object.fromEntries(\n    Object.keys(penalties).map((key) => {\n      const values = R.map(R.path(['properties', key]), tracks)\n      return [key, limits(values)]\n    })\n  )\n\n  const penaltyLookup = R.mapObjIndexed((_, key, ps) => {\n    const { min, max } = minAndMaxValuesForPenalties[key]\n\n    return {\n      weight: ps[key].weight,\n      values: normalize(min, max)(R.range(0, targetLength).map((i) => ps[key].fn(i))),\n    }\n  }, penalties)\n\n  const calculatePenalty = (level, track) => {\n    const mapped = Object.keys(penaltyLookup).map((name) => {\n      const penaltyObj = penaltyLookup[name]\n      return penaltyObj.weight * penaltyFn(penaltyObj.values[level], track.properties[name])\n    })\n    return R.sum(mapped)\n  }\n\n  const calculateTempoDifference = (t1, t2) => {\n    const normalDiff = Math.abs(1 - Math.min(t1.tempo, t2.tempo) / Math.max(t1.tempo, t2.tempo))\n    const scaledDiff = Math.abs(1 - (Math.min(t1.tempo, t2.tempo) * 2) / Math.max(t1.tempo, t2.tempo))\n    return Math.min(normalDiff, scaledDiff) * 100\n  }\n\n  let routes = []\n  let bestRoute = {\n    path: [],\n    penalty: Infinity,\n  }\n\n  const iterate = (node, outro, tracksLeft) => {\n    return new Promise((accept) =>\n      setImmediate(async () => {\n        const penalty = calculatePenalty(node.currentLength, node.track)\n        const currentPenalty = node.currentPenalty + penalty\n        const atTargetLength = node.currentLength === targetLength - (outro === undefined ? 1 : 2)\n        const suitableTracks = atTargetLength\n          ? undefined\n          : findSuitableTracksByKey(node.track, tracksLeft)\n              .filter((t) => calculateTempoDifference(node.track, t) < maxTempoDifference)\n              .filter((t) => !filterByPenalty || calculatePenalty(node.currentLength + 1, t) < tolerance)\n\n        if (atTargetLength) {\n          if (currentPenalty < bestRoute.penalty) {\n            let path = []\n            let currentNode = node\n            while (currentNode !== null) {\n              path.push(currentNode.track)\n              currentNode = currentNode.previous\n            }\n\n            let reversedPath = R.reverse(path)\n            bestRoute = {\n              penalty: currentPenalty,\n              path: outro === undefined ? reversedPath : [...reversedPath, outro],\n            }\n\n            routes.splice(0, 0, bestRoute)\n\n            console.log(`Found path with penalty: ${currentPenalty}`)\n          }\n        }\n\n        const tooFarFromOutro =\n          outro !== undefined && keyDistance(false)(node.track, outro) > targetLength - node.currentLength - 3\n\n        if (\n          tooFarFromOutro ||\n          atTargetLength ||\n          suitableTracks.length === 0 ||\n          (filterByPenalty && node.currentPenalty > bestRoute.penalty)\n        ) {\n          return accept()\n        }\n\n        let index = 0\n        for (const t of suitableTracks) {\n          if (node.currentLength === 0) {\n            console.log(`${Math.round(index / suitableTracks.length)}%`)\n            index++\n          }\n\n          await iterate(\n            {\n              previous: node,\n              track: t,\n              currentLength: node.currentLength + 1,\n              currentPenalty: node.currentPenalty + penalty,\n            },\n            outro,\n            R.without([t], tracksLeft)\n          )\n        }\n\n        return accept()\n      })\n    )\n  }\n\n  const graphStart = Date.now()\n\n  await promiseOrTimeout(\n    () =>\n      iterate(\n        {\n          previous: null,\n          track: intro,\n          currentLength: 0,\n          currentPenalty: 0,\n        },\n        outro,\n        R.without([intro, outro], tracks).sort(() => seedrandom(seed) - 0.5)\n      ),\n    timeout * 60 * 1000\n  )\n\n  const graphTime = Date.now() - graphStart\n\n  console.log('Graph done')\n  console.log(`Tracks: ${tracks.length}, Graph time: ${graphTime}`)\n\n  return routes\n}\n","export const promiseOrTimeout = (fn, timeout) => {\n  let timeoutId\n  return Promise.race([\n    new Promise(accept => timeoutId = setTimeout(() => {\n      console.log('Timeout!')\n      return accept()\n    }, timeout)),\n    new Promise(async accept => {\n      const result = await fn()\n      console.log('Done')\n      clearTimeout(timeoutId)\n      // TODO: this does not seem to work\n      return accept(result)\n    })]\n  )\n}\n","import Table from '@material-ui/core/Table'\nimport TableBody from '@material-ui/core/TableBody'\nimport TableCell from '@material-ui/core/TableCell'\nimport TableContainer from '@material-ui/core/TableContainer'\nimport TableHead from '@material-ui/core/TableHead'\nimport TableRow from '@material-ui/core/TableRow'\nimport Paper from '@material-ui/core/Paper'\n\nimport { getKeyString } from './lib/keys'\nimport makeStyles from '@material-ui/core/styles/makeStyles'\nimport Radio from '@material-ui/core/Radio'\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100%',\n  },\n  container: {\n    maxHeight: 400,\n  },\n})\n\nexport default function Tracklist({ tracks, editing, selectedTrackIndex, onTrackSelected }) {\n  const classes = useStyles()\n\n  return (\n    <Paper className={classes.root}>\n      <TableContainer className={classes.container}>\n        <Table stickyHeader size=\"small\">\n          <TableHead>\n            <TableRow>\n              {editing ? <TableCell>Select</TableCell> : null}\n              <TableCell>Artist</TableCell>\n              <TableCell>Title</TableCell>\n              <TableCell>Tempo</TableCell>\n              <TableCell>Key</TableCell>\n              {tracks[0]\n                ? Object.keys(tracks[0].properties).map((propertyName, i) => (\n                    <TableCell key={i}>{propertyName.replace(/^./, propertyName[0].toUpperCase())}</TableCell>\n                  ))\n                : null}\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {tracks.map((track, i) => (\n              <TableRow key={i}>\n                {editing ? (\n                  <TableCell key=\"select\">\n                    <Radio checked={selectedTrackIndex === i} onChange={() => onTrackSelected(i)} />\n                  </TableCell>\n                ) : null}\n                <TableCell>{track.artist}</TableCell>\n                <TableCell>{track.title}</TableCell>\n                <TableCell>{parseInt(track.tempo)}</TableCell>\n                <TableCell>{getKeyString(track.keyNumber, track.isMinor)}</TableCell>\n                {Object.values(track.properties).map((property) => (\n                  <TableCell key=\"property\">{property}</TableCell>\n                ))}\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n    </Paper>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport SpotifyWebApi from 'spotify-web-api-js'\nimport * as R from 'ramda'\nimport { OAuth2AuthCodePKCE } from '@bity/oauth2-auth-code-pkce'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Container from '@material-ui/core/Container'\nimport { Button, ButtonGroup } from '@material-ui/core'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormControl from '@material-ui/core/FormControl'\nimport Tracklist from './Tracklist'\nimport TextField from '@material-ui/core/TextField'\nimport Slider from '@material-ui/core/Slider'\nimport Select from '@material-ui/core/Select'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport Chart from 'react-apexcharts'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\nimport Input from '@material-ui/core/Input'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport GithubCorner from 'react-github-corner'\n\nimport { graphWalk } from './lib/graphWalk'\nimport defaultPlaylist from './test/playlist'\nimport parsePlaylist from './lib/parseTracklist'\nimport defaultTracklist from './test/tracklist'\nimport { absoluteSine, raisingSaw, saw } from './lib/penalties'\nimport { limits, normalize } from './lib/arrayHelppers'\nimport pathToTSV from './lib/pathToTSV'\nimport TracklistInstructions from './TracklistInstructions'\nimport pitchClassToCamelotKeyNumber from './lib/pitchClassToCamelotKeyNumber'\n\nconst minimumTrackCountForPenalties = 50\n\nconst firstProperty = (track) => R.path([0], Object.entries(track.properties))\nconst firstPropertyName = (track) => R.path([0], firstProperty(track))\nconst firstPropertyValue = (track) => R.path([1], firstProperty(track))\nconst getTargetValues = ({ min, max }, targetLength, fn) => {\n  return normalize(min, max)(R.range(0, targetLength).map((i) => fn(i)))\n}\n\nconst truncate = (length) => (input) => (input.length > length ? `${input.substring(0, length)}...` : input)\nconst truncateTitle = truncate(10)\n\nlet oauth\nlet spotify\n\nconst useStyles = makeStyles((theme) => ({\n  formControl: {\n    margin: theme.spacing(1),\n    width: '100%',\n  },\n  buttonRow: {\n    display: 'inline-block',\n    '& > *': {\n      margin: theme.spacing(1),\n    },\n  },\n}))\n\nconst Planner = () => {\n  const [tracklist, setTracklist] = useState(defaultPlaylist)\n  const [tracks, setTracks] = useState(parsePlaylist(tracklist))\n  const [paths, setPaths] = useState([])\n  const [selectedPath, setSelectedPath] = useState({ penalty: undefined, path: parsePlaylist(defaultTracklist) })\n  const [targetLength, setTargetLength] = useState(5)\n  const [timeout, setTimeout] = useState(2)\n  const [tolerance, setTolerance] = useState(1.5)\n  const [maxTempoDifference, setMaxTempoDifference] = useState(5)\n  const [processing, setProcessing] = useState(false)\n  const [editingPlaylist, setEditingPlaylist] = useState(false)\n  const [editingIntro, setEditingIntro] = useState(false)\n  const [editingOutro, setEditingOutro] = useState(false)\n  const [intro, setIntro] = useState(tracks[0])\n  const [outro, setOutro] = useState(undefined)\n  const [parametersChanged, setParametersChanged] = useState(true)\n  const [seed, setSeed] = useState(0)\n  const [showAdvancedOptions, setShowAdvancedOptions] = useState(false)\n  const [targetValues, setTargetValues] = useState(\n    [8, 8, 9, 9, 2, 3, 6, 9, 10, 5, 6, 7, 10, 10, 6, 7, 8, 9, 10, 10].map((value) => ({ value }))\n  )\n  const [processingMessage, setProcessingMessage] = useState('')\n  const [editingSelectedTracklistResult, setEditingSelectedTracklistResult] = useState(false)\n  const [selectedTracklist, setSelectedTracklist] = useState(defaultTracklist)\n  const parameterRange = limits(R.map(firstPropertyValue, tracks))\n  const targetFunctions = [\n    {\n      name: 'Raising Saw',\n      fn: raisingSaw(7, targetLength),\n    },\n    {\n      name: 'Saw',\n      fn: saw(7),\n    },\n    {\n      name: 'Absolute sine',\n      fn: absoluteSine,\n    },\n    {\n      name: 'Manual',\n      fn: (i) => targetValues[i].value,\n    },\n  ]\n  // const [targetProperty, setTargetProperty] = useState(firstPropertyName(tracks[0]))\n  // const [targetProperties, setTargetProperties] = useState(Object.keys(tracks[0].properties))\n  const [targetFn, setTargetFunction] = useState(targetFunctions[0])\n  const [cachedTargetValues, setCachedTargetValues] = useState(\n    getTargetValues(parameterRange, targetLength, targetFn.fn)\n  )\n  const [playlistDialogOpen, setPlaylistDialogOpen] = React.useState(false)\n  const [selectedSpotifyPlaylist, setSelectedSpotifyPlaylist] = React.useState('')\n  const [spotifyPlaylistItems, setSpotifyPlaylistItems] = React.useState([])\n  const [importingSpotifyPlaylist, setImportingSpotifyPlaylist] = React.useState(false)\n\n  const initializeAndOpenSpotifyPlaylistDialog = async (accessToken) => {\n    spotify = new SpotifyWebApi()\n    spotify.setAccessToken(accessToken.token.value)\n    const playlists = await spotify.getUserPlaylists()\n    setSpotifyPlaylistItems(playlists.items.map(({ name, id }) => ({ id, name })))\n\n    setPlaylistDialogOpen(true)\n  }\n\n  useEffect(() => {\n    if (!oauth) {\n      oauth = new OAuth2AuthCodePKCE({\n        authorizationUrl: `https://accounts.spotify.com/authorize`,\n        tokenUrl: `https://accounts.spotify.com/api/token`,\n        clientId: '01726eb65f8f4f28a640d74bd65deab1',\n        scopes: ['playlist-read-private'],\n        redirectUrl: process.env.REACT_APP_REDIRECT_URL || 'http://localhost:3000',\n        onAccessTokenExpiry(refreshAccessToken) {\n          console.log('Expired! Access token needs to be renewed.')\n          // alert('We will try to get a new access token via grant code or refresh token.')\n          return refreshAccessToken()\n        },\n        onInvalidGrant(refreshAuthCodeOrRefreshToken) {\n          console.log('Expired! Auth code or refresh token needs to be renewed.')\n          // alert('Redirecting to auth server to obtain a new auth grant code.')\n          //return refreshAuthCodeOrRefreshToken();\n        },\n      })\n\n      oauth\n        .isReturningFromAuthServer()\n        .then((hasAuthCode) => {\n          if (!hasAuthCode) {\n            console.log('Something wrong...no auth code.')\n          }\n          return oauth.getAccessToken().then((token) => initializeAndOpenSpotifyPlaylistDialog(token))\n        })\n        .catch((potentialError) => {\n          if (potentialError) {\n            console.log(potentialError)\n          }\n        })\n    }\n  })\n\n  const handlePlaylistDialogClose = () => {\n    setPlaylistDialogOpen(false)\n  }\n\n  const handlePlaylistSelected = async () => {\n    try {\n      setImportingSpotifyPlaylist(true)\n      const playlist = await spotify.getPlaylist(selectedSpotifyPlaylist)\n      const tracksFromPlaylist = playlist.tracks.items.map(({ track: { id, name, artists, popularity } }) => ({\n        id,\n        artist: artists.map(({ name }) => name).join(', '),\n        title: name,\n        popularity,\n      }))\n\n      const features = await spotify.getAudioFeaturesForTracks(tracksFromPlaylist.map(({ id }) => id))\n      let parsedPlaylist = R.zipWith(\n        ({ artist, title, popularity }, features) => ({\n          artist,\n          title,\n          keyNumber: pitchClassToCamelotKeyNumber[features.key],\n          isMinor: false,\n          tempo: features.tempo,\n          properties: {\n            Energy: Math.round(features.energy * 10),\n            // Danceability: Math.round(features.danceability * 10),\n            // Valence: Math.round(features.valence * 10),\n            // Instrumentalness: Math.round(features.instrumentalness * 10),\n            // Popularity: popularity,\n          },\n        }),\n        tracksFromPlaylist,\n        features.audio_features\n      )\n      setTracks(parsedPlaylist)\n      // setTargetProperty(firstPropertyName(parsedPlaylist[0]))\n      // setTargetProperties(Object.keys(parsedPlaylist[0].properties))\n\n      setEditingPlaylist(false)\n      setParametersChanged(true)\n      setIntro(parsedPlaylist[0])\n      setOutro(undefined)\n      setPlaylistDialogOpen(false)\n    } finally {\n      setImportingSpotifyPlaylist(false)\n    }\n  }\n\n  const handleSpotifyPlaylistChange = (event) => {\n    setSelectedSpotifyPlaylist(event.target.value)\n  }\n\n  const classes = useStyles()\n\n  return (\n    <>\n      <Container maxWidth=\"md\">\n        <h1>Mixtape Planner</h1>\n        <p>\n          There are a huge number of ways to arrange tracks and finding just the right one that matches the mood you are\n          after can be a burden. Want to go from one track to another, but just cannot seem to find the right tracks to\n          put in between them? This is just the right tool for the job!\n        </p>\n        <p>\n          Start by dropping a list of tracks below, selecing the track to start from, the track to end up at and the\n          mood you are after. Let the planner work its magic and prepare to be amazed by the combinations it spits out!\n        </p>\n        <p>\n          If giving the task of generating tracklists to a computer feels uncanny, you can use the tool for only\n          visualising your plans by heading over to the <a href=\"#result\">Result section</a> and dropping your tracks\n          there instead!\n        </p>\n        <h2>Parameters</h2>\n        <h3>Playlist</h3>\n        <div className={classes.buttonRow}>\n          <Button\n            size=\"small\"\n            color=\"primary\"\n            variant=\"contained\"\n            disabled={processing}\n            onClick={async () => {\n              try {\n                const accessToken = await oauth.getAccessToken()\n                await initializeAndOpenSpotifyPlaylistDialog(accessToken)\n              } catch (e) {\n                await oauth.fetchAuthorizationCode()\n              }\n            }}\n          >\n            Import from Spotify\n          </Button>\n          <Button\n            size=\"small\"\n            color=\"primary\"\n            variant=\"contained\"\n            disabled={processing}\n            onClick={() => {\n              if (editingPlaylist) {\n                setEditingPlaylist(false)\n                const parsedPlaylist = parsePlaylist(tracklist)\n                setTracks(parsedPlaylist)\n                setParametersChanged(true)\n                setIntro(parsedPlaylist.find(R.equals(intro)))\n                setOutro(parsedPlaylist.find(R.equals(outro)))\n              } else {\n                setEditingPlaylist(true)\n              }\n            }}\n          >\n            {editingPlaylist ? 'Parse' : 'Import / Edit TSV'}\n          </Button>\n        </div>\n        <Dialog disableBackdropClick disableEscapeKeyDown open={playlistDialogOpen} onClose={handlePlaylistDialogClose}>\n          <DialogTitle>Select playlist</DialogTitle>\n          <DialogContent>\n            <form>\n              <FormControl className={classes.formControl}>\n                <InputLabel id=\"demo-dialog-select-label\">Playlist</InputLabel>\n                <Select\n                  labelId=\"demo-dialog-select-label\"\n                  id=\"demo-dialog-select\"\n                  value={selectedSpotifyPlaylist}\n                  onChange={handleSpotifyPlaylistChange}\n                  input={<Input />}\n                >\n                  <MenuItem value=\"\"></MenuItem>\n                  {spotifyPlaylistItems.map(({ id, name }) => (\n                    <MenuItem value={id}>{name}</MenuItem>\n                  ))}\n                </Select>\n              </FormControl>\n            </form>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handlePlaylistDialogClose} color=\"primary\" disabled={importingSpotifyPlaylist}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handlePlaylistSelected}\n              color=\"primary\"\n              disabled={selectedSpotifyPlaylist === '' || importingSpotifyPlaylist}\n            >\n              Ok\n            </Button>\n          </DialogActions>\n        </Dialog>\n        {editingPlaylist ? (\n          <>\n            <br />\n            <br />\n            <TracklistInstructions>\n              After exporting the playlist, open the web page and copy and paste the contents (including the headers)\n              into the field below. Then click the Parse button above and if everything goes well, you are ready to\n              start generating interesting track combinations!\n            </TracklistInstructions>\n            <br />\n          </>\n        ) : (\n          <>\n            <h4>\n              First track\n              <div className={classes.buttonRow}>\n                <Button\n                  disabled={processing}\n                  size=\"small\"\n                  color=\"primary\"\n                  variant=\"contained\"\n                  onClick={() => setEditingIntro(!editingIntro)}\n                >\n                  {editingIntro ? 'Done' : 'Edit'}\n                </Button>\n              </div>\n            </h4>\n            <Tracklist\n              tracks={editingIntro ? tracks : [intro].filter(R.identity)}\n              key=\"intro\"\n              editing={editingIntro}\n              disabled={processing}\n              onTrackSelected={(i) => {\n                setIntro(tracks[i])\n                setParametersChanged(true)\n              }}\n              selectedTrackIndex={tracks.findIndex(R.equals(intro))}\n            />\n            <h4>\n              Last track{' '}\n              <div className={classes.buttonRow}>\n                <Button\n                  disabled={processing}\n                  size=\"small\"\n                  color=\"primary\"\n                  variant=\"contained\"\n                  onClick={() => setEditingOutro(!editingOutro)}\n                >\n                  {editingOutro ? 'Done' : 'Edit'}\n                </Button>\n                <Button\n                  disabled={processing || outro === undefined}\n                  size=\"small\"\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  onClick={() => setOutro(undefined)}\n                >\n                  Clear\n                </Button>\n              </div>\n            </h4>\n            {outro === undefined && !editingOutro ? (\n              'Last track not selected'\n            ) : (\n              <Tracklist\n                tracks={editingOutro ? tracks : [outro].filter(R.identity)}\n                key=\"outro\"\n                editing={editingOutro}\n                disabled={processing}\n                onTrackSelected={(i) => {\n                  setOutro(tracks[i])\n                  setParametersChanged(true)\n                }}\n                selectedTrackIndex={tracks.findIndex(R.equals(outro))}\n              />\n            )}\n            <h4>All tracks ({tracks.length} total)</h4>\n            <Tracklist tracks={tracks} key=\"middle\" />\n          </>\n        )}\n        <div style={{ display: editingPlaylist ? 'block' : 'none' }}>\n          <TextField\n            fullWidth={true}\n            rowsMax={20}\n            multiline\n            variant=\"outlined\"\n            onChange={(e) => {\n              setTracklist(e.target.value)\n            }}\n            onKeyDown={(e) => {\n              if (e.key === 'Tab') {\n                e.preventDefault()\n                const textArea = e.target\n                const start = textArea.selectionStart\n                const end = textArea.selectionEnd\n\n                textArea.value = textArea.value.substring(0, start) + '\\t' + textArea.value.substring(end)\n\n                // put caret at right position again\n                textArea.selectionStart = textArea.selectionEnd = start + 1\n\n                setTracklist(textArea.value)\n              }\n            }}\n            value={tracklist}\n          />\n        </div>\n        <h3>Target length (tracks incl. first and last)</h3>\n        <Slider\n          min={outro === undefined ? 2 : 3}\n          max={30}\n          valueLabelDisplay=\"on\"\n          value={targetLength}\n          disabled={processing}\n          style={{ marginTop: 20 }}\n          onChange={(_, value) => {\n            setTargetLength(value)\n            setParametersChanged(true)\n            setCachedTargetValues(getTargetValues(parameterRange, targetLength, targetFn.fn))\n          }}\n        />\n        {/*<h3>Target property</h3>*/}\n        {/*<Select value={targetProperty}>*/}\n        {/*  {targetProperties.map((property) => (*/}\n        {/*    <MenuItem value={property} key={property}>*/}\n        {/*      {property}*/}\n        {/*    </MenuItem>*/}\n        {/*  ))}*/}\n        {/*</Select>*/}\n        <h3>Target curve</h3>\n        <Select\n          value={targetFn.name}\n          disabled={processing}\n          onChange={(e) => {\n            const tf = targetFunctions.find(R.propEq('name', e.target.value))\n            setTargetFunction(tf)\n            setParametersChanged(true)\n            setCachedTargetValues(getTargetValues(parameterRange, targetLength, tf.fn))\n          }}\n        >\n          {targetFunctions.map(({ name }) => (\n            <MenuItem value={name} key={name}>\n              {name}\n            </MenuItem>\n          ))}\n        </Select>\n        {targetFn.name === 'Manual' ? (\n          <>\n            <h4>Values</h4>\n            {R.range(0, targetLength).map((i) => (\n              <>\n                {i !== 0 && i % 10 === 0 ? <br /> : null}\n                <TextField\n                  size=\"small\"\n                  variant=\"outlined\"\n                  style={{ width: 60, marginBottom: 10 }}\n                  label={(i + 1).toString()}\n                  key={i}\n                  value={targetValues[i].value}\n                  onChange={(e) => {\n                    targetValues[i].value = R.clamp(0, 10, parseInt(e.target.value) || 0)\n                    setTargetValues([...targetValues])\n                    setParametersChanged(true)\n                  }}\n                />\n              </>\n            ))}\n          </>\n        ) : null}\n        <Chart\n          options={{\n            chart: {\n              id: 'apexchart-example',\n            },\n            xaxis: {\n              categories: R.range(1, targetLength + 1),\n            },\n          }}\n          series={[\n            {\n              name: 'energy target',\n              data: getTargetValues(\n                targetFn.name === 'Manual' ? limits(R.pluck('value', targetValues)) : parameterRange,\n                targetLength,\n                targetFn.fn\n              ),\n            },\n          ]}\n          height=\"200\"\n        />\n        <FormControlLabel\n          control={\n            <Switch\n              checked={showAdvancedOptions}\n              onChange={() => {\n                setShowAdvancedOptions(!showAdvancedOptions)\n              }}\n            />\n          }\n          label=\"Show advanced options\"\n        />\n        {showAdvancedOptions ? (\n          <>\n            <h3>Processing timeout (minutes)</h3>\n            <Slider\n              min={0.5}\n              max={5}\n              step={0.1}\n              valueLabelDisplay=\"on\"\n              value={timeout}\n              disabled={processing}\n              onChange={(_, value) => {\n                setTimeout(value)\n                setParametersChanged(true)\n              }}\n            />\n            <h4>Maximum tempo difference (%)</h4>\n            <Slider\n              min={0.0}\n              max={20.0}\n              step={0.1}\n              valueLabelDisplay=\"on\"\n              value={maxTempoDifference}\n              disabled={processing}\n              onChange={(_, value) => {\n                setMaxTempoDifference(Number(value))\n                setParametersChanged(true)\n              }}\n            />\n            {tracks.length < minimumTrackCountForPenalties ? null : (\n              <>\n                <h4>Tolerance (use bigger value if smaller do not give results)</h4>\n                <Slider\n                  min={0.0}\n                  max={5.0}\n                  step={0.1}\n                  valueLabelDisplay=\"on\"\n                  value={tolerance}\n                  disabled={processing}\n                  onChange={(_, value) => {\n                    setTolerance(Number(value))\n                    setParametersChanged(true)\n                  }}\n                />\n              </>\n            )}\n\n            <h4>Seed</h4>\n            <Input\n              size=\"small\"\n              value={seed}\n              disabled={processing}\n              onChange={(e) => setSeed(parseInt(e.target.value) || 0)}\n            />\n            <Button\n              size=\"small\"\n              variant=\"contained\"\n              color=\"primary\"\n              disabled={processing}\n              onClick={() => {\n                setSeed(Math.round(Math.random() * 1000000))\n                setParametersChanged(true)\n              }}\n            >\n              Generate seed\n            </Button>\n          </>\n        ) : null}\n        <p>\n          <Button\n            color=\"primary\"\n            variant=\"contained\"\n            disabled={!intro || (!parametersChanged && paths.length !== 0) || processing || editingPlaylist}\n            onClick={async () => {\n              setProcessing(true)\n              setPaths([])\n              setProcessingMessage('')\n\n              document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'end' })\n\n              const paths = await graphWalk({\n                tracks,\n                intro,\n                outro,\n                targetLength,\n                tolerance,\n                maxTempoDifference,\n                filterByPenalty: tracks.length > minimumTrackCountForPenalties,\n                timeout,\n                seed,\n                penalties: { [firstPropertyName(tracks[0])]: { weight: 1, fn: targetFn.fn } },\n              })\n\n              setCachedTargetValues(getTargetValues(parameterRange, targetLength, targetFn.fn))\n              setParametersChanged(false)\n              setPaths(paths)\n\n              if (paths.length > 0) {\n                setSelectedPath(paths[0])\n              }\n\n              setProcessing(false)\n              setEditingSelectedTracklistResult(false)\n\n              setProcessingMessage(\n                paths.length === 0 ? 'No suitable orders found. Try increasing processing timeout or tolerance' : ''\n              )\n            }}\n          >\n            Generate order\n          </Button>\n        </p>\n        {processingMessage ? <p>{processingMessage}</p> : null}\n        {processing ? (\n          <>\n            <p>Calculating...</p>\n            <CircularProgress />\n          </>\n        ) : null}\n        <div style={{ minHeight: 100 }}>\n          <h2 id=\"result\">Result</h2>\n          {!processing ? (\n            <>\n              <ButtonGroup color=\"primary\" variant=\"contained\">\n                {paths.map((path, i) => (\n                  <Button\n                    key={i}\n                    color={path === selectedPath ? 'secondary' : 'primary'}\n                    onClick={() => {\n                      setSelectedPath(path)\n                      setSelectedTracklist(pathToTSV(path.path))\n                    }}\n                  >\n                    {i + 1}\n                  </Button>\n                ))}\n              </ButtonGroup>\n              <h3>\n                Tracklist\n                <div className={classes.buttonRow}>\n                  <Button\n                    disabled={processing}\n                    size=\"small\"\n                    color=\"primary\"\n                    variant=\"contained\"\n                    onClick={() => {\n                      if (!editingSelectedTracklistResult) {\n                        if (selectedPath.path.length !== 0) {\n                          setSelectedTracklist(pathToTSV(selectedPath.path))\n                        }\n                      }\n                      setEditingSelectedTracklistResult(!editingSelectedTracklistResult)\n                    }}\n                  >\n                    {editingSelectedTracklistResult ? 'Parse' : 'Edit'}\n                  </Button>\n                </div>\n              </h3>\n              {!editingSelectedTracklistResult ? (\n                <Tracklist tracks={selectedPath.path} />\n              ) : (\n                <>\n                  <TracklistInstructions>\n                    After exporting the playlist, open the web page and copy and paste the contents (including the\n                    headers) into the field below. Then click the Done button above and if everything goes well, the\n                    graphs should update!\n                  </TracklistInstructions>\n                  <br />\n                  <TextField\n                    fullWidth={true}\n                    rowsMax={20}\n                    multiline\n                    display={editingSelectedTracklistResult ? 'block' : 'none'}\n                    variant=\"outlined\"\n                    onChange={(e) => {\n                      const textArea = e.target\n                      setSelectedTracklist(textArea.value)\n                      selectedPath.path = parsePlaylist(textArea.value)\n                      selectedPath.penalty = undefined\n                      setSelectedPath(selectedPath)\n                      const newLength = selectedPath.path.length\n                      if (newLength > targetLength) {\n                        setTargetLength(newLength)\n                        setCachedTargetValues(getTargetValues(parameterRange, newLength, targetFn.fn))\n                      }\n                    }}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Tab') {\n                        e.preventDefault()\n                        const textArea = e.target\n                        const start = textArea.selectionStart\n                        const end = textArea.selectionEnd\n\n                        textArea.value = textArea.value.substring(0, start) + '\\t' + textArea.value.substring(end)\n                        textArea.selectionStart = textArea.selectionEnd = start + 1\n                        setSelectedTracklist(textArea.value)\n\n                        selectedPath.path = parsePlaylist(textArea.value)\n                        selectedPath.penalty = undefined\n                        setSelectedPath(selectedPath)\n                        const newLength = selectedPath.path.length\n                        if (newLength > targetLength) {\n                          setTargetLength(newLength)\n                          setCachedTargetValues(getTargetValues(parameterRange, newLength, targetFn.fn))\n                        }\n                      }\n                    }}\n                    value={selectedTracklist}\n                  />\n                </>\n              )}\n              <>\n                {!selectedPath || !selectedPath.penalty ? null : (\n                  <h3>Correlation with target curve ({Math.round(selectedPath.penalty * 100) / 100})</h3>\n                )}\n                <Chart\n                  options={{\n                    chart: {\n                      id: 'apexchart-example',\n                    },\n                    xaxis: {\n                      categories: selectedPath.path.map((pathItem) => truncateTitle(pathItem.title)),\n                      name: 'Track',\n                    },\n                    yaxis: {\n                      labels: {\n                        formatter: function (val) {\n                          return Math.floor(val)\n                        },\n                      },\n                    },\n                  }}\n                  series={[\n                    {\n                      name: 'Target',\n                      data: cachedTargetValues,\n                    },\n                    {\n                      name: 'Actual',\n                      data: selectedPath.path.map(firstPropertyValue),\n                    },\n                  ]}\n                  height=\"200\"\n                />\n                <h3>Keys</h3>\n                <Chart\n                  options={{\n                    chart: {\n                      id: 'apexchart-example',\n                    },\n                    xaxis: {\n                      categories: selectedPath.path.map((pathItem) => truncateTitle(pathItem.title)),\n                    },\n                  }}\n                  series={[\n                    {\n                      name: 'key',\n                      data: selectedPath.path.map(R.prop('keyNumber')),\n                    },\n                  ]}\n                  height=\"200\"\n                />\n              </>\n            </>\n          ) : null}\n        </div>\n      </Container>\n      <GithubCorner href=\"https://github.com/gadgetmies/mixtape_planner\" target=\"_blank\" />\n    </>\n  )\n}\n\nexport default Planner\n","import assert from 'assert'\n\nconst parseTracklist = (list) => {\n  const rows = list\n    .trim()\n    .split('\\n')\n    .map((l) => l.trim().split('\\t'))\n\n  if (rows.length === 0) return []\n  const headers = rows[0]\n  const validRows = rows.filter((r) => r.length === headers.length)\n  assert(headers[0].toLowerCase() === 'artist')\n  assert(headers[1].toLowerCase() === 'title')\n  assert(headers[2].toLowerCase() === 'tempo')\n  assert(headers[3].toLowerCase() === 'key' || headers[2] === 'key text')\n\n  const propertyNames = headers.slice(4)\n\n  return validRows.slice(1).map(([artist, title, tempo, key, ...propertyValues]) => {\n    try {\n      return {\n        title,\n        artist,\n        keyNumber: parseInt(key.slice(0, -1)),\n        isMinor: key[key.length - 1] === 'B' || key[key.length - 1] === 'd',\n        tempo: parseInt(tempo),\n        properties: Object.fromEntries(propertyValues.map((value, i) => [propertyNames[i], value.match(/(\\d+)$/)[1]])),\n      }\n    } catch (e) {\n      console.error(`Error processing row: ${title} ${artist} ${key} ${propertyValues}`)\n      throw e\n    }\n  })\n}\nexport default parseTracklist\n","const tracklist = `Artist\\tTitle\\tTempo\\tKey\\tComment\nInspected\\tDestroy\\t174\\t11A\\t1\nSweatson Klank\\tSmile (Original Mix)\\t174\\t10B\\t2\nInspected\\tOnce\\t174\\t9A\\t3\nShield\\tSlavik\\t174\\t8A\\t6\nIvy Lab\\tHotel Motel (Original Mix)\\t174\\t7A\\t7\n`\nexport default tracklist\n","import { getKeyString } from './keys'\n\nconst pathToTSV = (path) => {\n  const header = `Artist\\tTitle\\tTempo\\tKey\\t${Object.keys(path[0].properties).join('\\t')}`\n  const tracks = path\n    .map(\n      ({ title, artist, keyNumber, isMinor, tempo, properties }) =>\n        `${artist}\\t${title}\\t${tempo}\\t${getKeyString(keyNumber, isMinor)}\\t${Object.values(properties).join('\\t')}`\n    )\n    .join('\\n')\n\n  return `${header}\\n${tracks}`\n}\n\nexport default pathToTSV\n","import Accordion from '@material-ui/core/Accordion'\nimport AccordionSummary from '@material-ui/core/AccordionSummary'\nimport InfoIcon from '@material-ui/icons/Info'\nimport AccordionDetails from '@material-ui/core/AccordionDetails'\nimport Typography from '@material-ui/core/Typography'\nimport React from 'react'\n\nconst TracklistInstructions = (props) => (\n  <Accordion>\n    <AccordionSummary\n      expandIcon={<InfoIcon color={'primary'} />}\n      aria-label=\"Expand\"\n      aria-controls=\"additional-actions1-content\"\n      id=\"additional-actions1-header\"\n    >\n      Instructions\n    </AccordionSummary>\n    <AccordionDetails>\n      <Typography>\n        The planner is rather picky about the input it gets currently (a TSV formatted text with Artist, Title, Key and\n        Comment columns). In order to produce such a file do the following:\n        <br />\n        <br />\n        Export a playlist from Traktor as a web page. Include the Artist, Title, Key (or Key Text) and Comment columns.\n        The planner uses the Comment column as input for the mood (target curve). The column can contain other data as\n        well, but it needs to end with a number. If you are using <a href=\"https://mixedinkey.com\">Mixed in Key</a>, you\n        can configure it to write the energy level to the comment tag (Settings > Update Tags > Where to write it >\n        Overwrite comments). If you do not have Mixed in Key, you can use a service like{' '}\n        <a href=\"https://tunebat.com\">Tunebat</a> to get the key and mood info.\n        <br />\n        <br />\n        {props.children}\n      </Typography>\n    </AccordionDetails>\n  </Accordion>\n)\nexport default TracklistInstructions\n","const pitchClassToCamelotKeyNumber = [5, 12, 7, 2, 9, 4, 11, 6, 1, 8, 3, 10]\nexport default pitchClassToCamelotKeyNumber\n","const playlist = `Artist\\tTitle\\tTempo\\tKey\\tComment\nInspected\\tDestroy\\t174\\t11A\\t1\nEPROM\\t9 To Ya Dome\\t174\\t12A\\t6\ndope\\tIt Ain't Bangin'\\t174\\t4A\\t6\nEPROM & G Jones\\tWarrior\\t174\\t4A\\t2\nEPROM\\tSamurai\\t174\\t4A\\t9\nEPROM\\tBrixton\\t174\\t4A\\t4\nHolly\\tHolly & Mr. Bill - Geen Idee\\t174\\t9A\\t5\nInspected\\tRead\\t174\\t9A\\t2\nInspected\\tOnce\\t174\\t9A\\t3\nInspected\\tThen\\t174\\t9A\\t9\nKursa\\tTsuto\\t174\\t4A\\t6\nKursa\\tDat Style\\t174\\t4A\\t6\nKursa\\tHip-Hopeless\\t174\\t4A\\t6\nKursa X Lone Drum\\tUnarmoured Sulk\\t174\\t4A\\t7\nKursa\\tYea, OK\\t174\\t12A\\t6\nMark Instinct\\tMark Instinct - Singularity\\t174\\t9A\\t8\nSKEW & occup\\tBad Replica\\t174\\t5A\\t10\nSkew & ReDraft\\tNo Hype\\t174\\t4A\\t4\nSKEW\\tCharged Up\\t174\\t9A\\t7\nSKEW\\tDon Robot\\t174\\t5A\\t7\nSKEW\\tCyborg Rising\\t174\\t1A\\t4\nSKEW\\tAcid Meltdown\\t174\\t2A\\t2\nDroeloe\\tStep By Step (Fytch Remix)\\t174\\t10A\\t6\nMo Vibez\\tLike Us (Original Mix)\\t174\\t10A\\t8\nEkcle\\tCrafted In Ice\\t174\\t10A\\t7\nFytch, Graves\\tExhale feat. Fytch (Original Mix)\\t174\\t11A\\t6\nShades\\tGravediggin' feat. Alix Perez and Eprom (Original Mix)\\t174\\t11A\\t3\nAleph\\tGoliath (Original Mix)\\t174\\t11A\\t2\nSofie Letitre\\tI'll Be Fine (Zes Remix)\\t174\\t11A\\t8\nShades\\tCreepin' (Original Mix)\\t174\\t11A\\t7\nMonty\\tSharp Teeth (Original Mix)\\t174\\t11A\\t8\nyunis\\tIllusions\\t174\\t11A\\t6\nSignal, Disprove, Ordure\\tZwendel feat. Ordure (Original Mix)\\t174\\t12A\\t7\nRun Dmt, Vorso\\tGamma Ray (feat. Vorso) (Original Mix)\\t174\\t12A\\t5\nKije\\tMorze (Original Mix)\\t174\\t12A\\t6\nRun Dmt\\tTesseract (Vorso Remix)\\t174\\t1A\\t0\nChee\\tPedigrief (Original Mix)\\t174\\t1A\\t7\nMystic State\\tEffwatya (Ft.Third Degree)\\t174\\t2A\\t5\nG Jones\\tIn Your Head (Original Mix)\\t174\\t2A\\t8\nSigns\\tPolymorph (Original Mix)\\t174\\t2A\\t7\nMo Vibez, L.o.J, L*o*J\\tWisdom (Feat. L*o*J) feat. L*o*J (Original Mix)\\t174\\t2A\\t4\nBalatron\\tWay Back (Original Mix)\\t174\\t2B\\t9\nBalatron\\tPoseidon (Original Mix)\\t174\\t2B\\t6\nMystic State\\tWhole Half\\t174\\t2B\\t6\nBalatron\\tHUGINN (Original Mix)\\t174\\t2B\\t7\nCesco\\tDrones\\t174\\t4A\\t6\nMr.Frenkie\\tAttrakt (Original Mix)\\t174\\t4A\\t8\nSigns\\tNaegleria (Original Mix)\\t174\\t4A\\t7\nEnei\\tCrunchy (Original Mix)\\t174\\t4A\\t4\nAleph\\tSolomon (Original Mix)\\t174\\t4A\\t6\nShield\\tVatos\\t174\\t4A\\t8\nCrimes!\\tClicc (Original Mix)\\t174\\t4A\\t7\nThelem\\tThird Time Lucky\\t174\\t4A\\t8\nV. A.\\tDJ Ride - Pump My\\t174\\t4A\\t6\nBalatron\\tD.Y.E Pop (Original Mix)\\t174\\t4A\\t5\nSigns\\tSkin Out (Original Mix)\\t174\\t4A\\t4\nDJ Craze, Icicle, Teddy Killerz\\tLouder feat. DJ Craze (Original Mix)\\t174\\t4A\\t7\nEmperor\\tJounce (Ivy Lab's 20/20 Remix)\\t174\\t4A\\t6\nIvy Lab\\tMagikess (Original Mix)\\t174\\t4A\\t6\nVue\\tHologram (Original Mix)\\t174\\t4A\\t5\nChee\\tGet Hot ft. Noclu (G Jones Remix)\\t174\\t4A\\t8\nKursa\\tPrecisely\\t174\\t4A\\t7\nV. A.\\tVorso - Cephalopod\\t174\\t4A\\t8\nWoolymammoth\\tPrasak (Original Mix)\\t174\\t4A\\t4\nCrimes!\\tRealson (Original Mix)\\t174\\t4A\\t7\nTsuruda\\tKicking Wolf\\t174\\t4A\\t5\nMefjus\\tRingshifter (Culprate Remix)\\t174\\t4A\\t8\nCulprate & Skope\\tBlowfish\\t174\\t4A\\t6\nIvy Lab\\tIvy Lab - Jinxed\\t174\\t4A\\t5\nBreak, SpectraSoul\\tInside (Original Mix)\\t174\\t4A\\t3\nARKTKT\\tUminari\\t174\\t5A\\t5\nCreepa, Mo Vibez\\tDR777 (Original Mix)\\t174\\t5A\\t4\nARKTKT\\tTesseract\\t174\\t5A\\t5\nMystic State\\tZoo (Ft.Jakaboski)\\t174\\t5A\\t6\nShield\\tDank Drip\\t174\\t5A\\t5\nAk:Hash\\tShady (Original Mix)\\t174\\t6A\\t9\nBalatron\\tFlip Your Hands (Original Mix)\\t174\\t6A\\t10\nCraze, Balatron\\tWord Up (feat. Balatron) (Original Mix)\\t174\\t6A\\t8\nShield\\tViking Journey\\t174\\t6A\\t7\nBalatron\\tMUNINN (Original Mix)\\t174\\t6A\\t7\nHerzeloyde\\tSlice & Dice\\t174\\t7A\\t5\nEkcle\\tWithin The Palms Of A God\\t174\\t7A\\t6\nV. A.\\tSkew & yunis - Trippin\\t174\\t7A\\t8\nSignal, Apashe, Black Prez\\tDies Irae (Signal Remix)\\t174\\t7A\\t6\nIvy Lab\\tHotel Motel (Original Mix)\\t174\\t7A\\t7\nEwol\\tDespair (Ak:Hash Remix)\\t174\\t7A\\t6\nShield\\tSlavik\\t174\\t8A\\t6\nEkcle\\tMoonstone\\t174\\t8A\\t6\nShades\\tIron Sharpens Iron (Original Mix)\\t174\\t8A\\t6\nAk:Hash\\tStoner (Original Mix)\\t174\\t8A\\t3\nShield\\tChicago\\t174\\t8A\\t1\nShield\\tDracula\\t174\\t8A\\t6\nShield\\tHorrormovie (Shuffle Edit)\\t174\\t8A\\t6\nShield\\tBowling Frontier\\t174\\t9A\\t6\nHerzeloyde\\tInverted Bumps ft Hapa & Tsuruda\\t174\\t9A\\t6\nMo Vibez\\tModulation\\t174\\t9A\\t8\nV. A.\\t1-800-BAD-TRIP - Turtle Soup\\t174\\t9A\\t7\nShades\\tChiron (Remix)\\t174\\t9A\\t0\nPhazz\\tCaution (Original Mix)\\t174\\t9A\\t6\nShield\\tHome Alone\\t174\\t9A\\t7\nShield\\tHorrormovie (Dirty VIP)\\t174\\t9A\\t5\nKije\\tOnce Again (Original Mix)\\t174\\t9A\\t8\nShades, Ivy Lab\\tSleaze (Original Mix)\\t174\\t9A\\t5\nCrimes!\\tFXXXUp (Original Mix)\\t174\\t9A\\t9\nSabre\\tYoga (Original Mix)\\t174\\t9A\\t6\nCraze, Shield\\tHumans are Stupid (feat. Shield) (Original Mix)\\t174\\t9A\\t5\nJon Casey\\tDimes\\t174\\t9A\\t8\nMad Zach\\tRobovox (Original Mix)\\t174\\t2d\\t1\nJUNE MILLER/TEDDY KILLERZ\\tWildlife (CVPELLV remix)\\t174\\t9A\\t5\nMonuman\\tRise\\t174\\t2A\\t9\nNoisia/Ivy Lab\\tPossession\\t174\\t7A\\t6\nSHIELD\\tFools\\t174\\t4A\\t8\nShield & Submarine\\tMarch Of Giants\\t174\\t4A\\t2\nSigns\\tClap Yah\\t174\\t4A\\t6\nNoisia, Mono & Poly\\tThe Nomad\\t174\\t5A\\t1\nBlack Sun Empire, Noisia\\tHideous (Doctrine Remix)\\t174\\t6A\\t5\nSHIELD\\tMy Flava\\t174\\t6A\\t4\nRICHIE BRAINS\\tLikkle Som\\t174\\t8A\\t2\nIVY LAB\\tBerlusconi\\t174\\t8A\\t7\nBleep Bloop\\tRecombine\\t174\\t9A\\t2\nIvy Lab & Tim Parker\\tU Smart\\t174\\t9A\\t5\nPosij\\tGrab The Cookie\\t174\\t9A\\t5\nFlosstradamus\\tRoll Up (Baauer Remix)\\t174\\t4A\\t9\nEmperor\\tForeword (Original Mix)\\t174\\t2B\\t7\nSigns\\tUnchained\\t174\\t4A\\t0\nSigns\\tSacrilge (Original Mix)\\t174\\t4A\\t2\nSigns, Sotilas\\tFrench Slang (Original Mix)\\t174\\t4A\\t5\n\\t4A - 170 - Shield - Horrormovie (Full)\\t174\\t4A\\t6\nLevela\\tRiot Shield\\t174\\t4A\\t10\nShield\\tDomestic Problems\\t174\\t6A\\t2\nShield\\tHollywood Swing\\t174\\t6A\\t2\nHolly\\tHolly vs. Shield - Schizo\\t174\\t4A\\t7\nHolly\\tHolly vs. Shield - Schizo (Subp Yao Remix)\\t174\\t9A\\t6\nShield, Ordure\\tDumflad (Original Mix)\\t174\\t4A\\t6\nShield\\tBe_F\\t174\\t4A\\t1\nShield & 2Stars\\tPink Soap\\t174\\t5A\\t3\nShield\\tSkippy Vinyl (Original Mix)\\t174\\t5A\\t3\n\\tShield - Nightlife (CART FREEBIE)\\t174\\t6A\\t1\n\\tShield - I Like That (CART FREEBIE) v2\\t174\\t6A\\t10\nShield\\tGoofy (Original Mix)\\t174\\t7A\\t6\nShield\\tCopenhagen (Original Mix)\\t174\\t9A\\t2\nPEREZ, Alix/EPROM\\tChiron\\t174\\t9A\\t4\nShades\\tPowers of Two feat. Alix Perez and Eprom (Original Mix)\\t174\\t6B\\t7\nShades\\tSickle (Original Mix)\\t174\\t6A\\t6\nIvy Lab\\tCalculate (Original Mix)\\t174\\t10A\\t6\nMonuman\\tSasquatch (Original Mix)\\t174\\t4A\\t7\nEprom\\tPipe Dream (Original Mix)\\t174\\t5A\\t1\nEprom, ZEKE BEATS\\tHumanoid 2.0 (Original Mix)\\t174\\t4A\\t8\nBalatron\\tZero Caliber (Original Mix)\\t174\\t11A\\t6\nBalatron\\tPoseidon (Original Mix)\\t174\\t2B\\t7\nBalatron\\tStraight Thuggin (Original Mix)\\t174\\t4A\\t6\nBalatron\\tNeck Snapper (Original Mix)\\t174\\t4A\\t0\nIVY LAB\\tUbane\\t174\\t9A\\t8\nIVY LAB\\tPlanebeats\\t174\\t4A\\t3\nIvy Lab\\tSunday Crunk (Mefjus Remix)\\t174\\t8A\\t7\nIVY LAB\\tThird World Cop\\t174\\t2A\\t1\nEmperor, Ivy Lab\\tPepper (Deft Remix)\\t174\\t4A\\t8\nIvy Lab\\tShamrock V.I.P (Original Mix)\\t174\\t9A\\t9\nIvy Lab\\tStars (Original Mix)\\t174\\t9A\\t1\nIvy Lab\\tAll Day Swimming (Original Mix)\\t174\\t7A\\t4\nTwo Fingers, Ivy Lab\\tOrange (Original Mix)\\t174\\t6A\\t3\nTwo Fingers, Ivy Lab\\tHotline (Original Mix)\\t174\\t6A\\t7\nIvy Lab x Two Fingers\\t\"Hotline\"\\t174\\t6A\\t10\nIvy Lab\\tIvy Lab - Space War 169 (Instrumental)\\t174\\t4A\\t2\nIvy Lab\\tIvy Lab feat. Onoe Caponoe & L-Zee Roselli - Space War 169\\t174\\t4A\\t6\nIvy Lab\\tSpooky Dub (Original Mix)\\t174\\t4A\\t5\nIvy Lab\\tChic (Original Mix)\\t174\\t4A\\t4\nIvy Lab\\t650 CC (Original Mix)\\t174\\t4A\\t0\nIvy Lab\\tIvy Lab - Wideboi\\t174\\t1B\\t7\nIvy Lab\\tIvy Lab - Zip It\\t174\\t11A\\t0\nIvy Lab\\tWhen I Go (Original Mix)\\t174\\t10A\\t7\nTsuruda\\tHammer (Original Mix)\\t174\\t9A\\t5\nTsuruda\\tJokes (Original Mix)\\t174\\t9A\\t6\nTsuruda\\tOut Here (Original Mix)\\t174\\t2A\\t8\nTsuruda\\tPack Heat (Original Mix)\\t174\\t12A\\t2\nTsuruda\\tCousin Litt's Revenge (Original Mix)\\t174\\t11A\\t7\nTsuruda\\traider (Original Mix)\\t174\\t9A\\t7\nBleep Bloop, Tsuruda\\tTremors (Original Mix)\\t174\\t4A\\t9\nTim Parker\\tWarped Wing (Original Mix)\\t174\\t6A\\t6\nTim Parker\\tRules (Original Mix)\\t174\\t5A\\t10\nCruk, Shyun\\tCreatures (Original Mix)\\t174\\t4A\\t3\nMono/Poly\\tTeach You All A Lesson\\t174\\t5A\\t2\nG Jones\\tImmortal Light (Original Mix)\\t174\\t4A\\t9\nEPROM & G Jones\\tWarrior\\t174\\t4A\\t7\nG Jones\\tTime (Original Mix)\\t174\\t5A\\t4\nG Jones\\tHelix (Original Mix)\\t174\\t11A\\t1\nIMANU\\tNoir (Original Mix)\\t174\\t9A\\t7\nIMANU\\tDream Mentor (Original Mix)\\t174\\t4A\\t2\nHolly, Machinedrum\\tBerry Patch (IMANU Remix)\\t174\\t12A\\t3\nPosij\\tHella Sideways (Original Mix)\\t174\\t12B\\t2\nSweatson Klank\\tSmile (Original Mix)\\t174\\t10B\\t2\nNoer the Boy\\tNosferatu's Castle (Original Mix)\\t174\\t5A\\t9\nNoer the Boy\\tZaroff (Original Mix)\\t174\\t4A\\t5\nNoer the Boy\\tTour (Original Mix)\\t174\\t2A\\t4\nTek Genesis\\tRaid (Jon Casey Remix)\\t174\\t7A\\t9\nMark Instinct\\tMark Instinct & Holly - The Bends (CRIMES! Remix)\\t174\\t4A\\t1\nBalatron\\tDat Buddah Shii (Original Mix)\\t174\\t6A\\t0\nBalatron\\tZout (Original Mix)\\t174\\t4A\\t9\nBalatron\\tActively Faded (Original Mix)\\t174\\t9A\\t5\nTorbjrn\\tMan's Got Game (Sigrah Remix)\\t174\\t12A\\t8\nMefjus\\tAssembler (Original Mix)\\t174\\t7A\\t10\n`\nexport default playlist\n","import GithubCorner from 'react-github-corner'\nimport React, { useState } from 'react'\nimport { useUrlSearchParams } from 'use-url-search-params'\nimport TextField from '@material-ui/core/TextField'\nimport parsePlaylist from './lib/parseTracklist'\nimport Chart from 'react-apexcharts'\nimport * as R from 'ramda'\nimport TracklistInstructions from './TracklistInstructions'\nimport Container from '@material-ui/core/Container'\nimport { TwitterShareButton, TwitterIcon, FacebookShareButton, FacebookIcon } from '@kashuab/react-share'\nimport tinyurl from 'tinyurl'\n\nconst truncate = (length) => (input) => (input.length > length ? `${input.substring(0, length)}...` : input)\nconst truncateTitle = truncate(10)\nconst firstProperty = (track) => R.path([0], Object.entries(track.properties))\nconst firstPropertyValue = (track) => R.path([1], firstProperty(track))\n\nconst Visualizer = () => {\n  const [params, setParams] = useUrlSearchParams({ tracklist: '' })\n  if (params.tracklist.indexOf('Artist') === -1) {\n    setParams({ tracklist: 'Artist\\tTitle\\tTempo\\tKey\\tComment\\n' + params.tracklist })\n  }\n  const [parsedTracklist, setParsedTracklist] = useState(parsePlaylist(params.tracklist))\n\n  const shortenUrl = () => tinyurl.shorten(window.location)\n\n  return (\n    <>\n      <Container maxWidth=\"md\">\n        <h1>Mixtape Visualizer</h1>\n        <TracklistInstructions>\n          After exporting the playlist, open the web page and copy and paste the contents (including the headers) into\n          the field below. Then click the Done button above and if everything goes well, the graphs should update!\n        </TracklistInstructions>\n        <br />\n        <TextField\n          fullWidth={true}\n          rowsMax={20}\n          multiline\n          variant=\"outlined\"\n          onChange={(e) => {\n            const textArea = e.target\n            setParams({ tracklist: textArea.value })\n            setParsedTracklist(parsePlaylist(textArea.value))\n          }}\n          onKeyDown={(e) => {\n            if (e.key === 'Tab') {\n              e.preventDefault()\n              const textArea = e.target\n              const start = textArea.selectionStart\n              const end = textArea.selectionEnd\n\n              textArea.value = textArea.value.substring(0, start) + '\\t' + textArea.value.substring(end)\n              textArea.selectionStart = textArea.selectionEnd = start + 1\n              setParams({ tracklist: textArea.value })\n              setParsedTracklist(parsePlaylist(textArea.value))\n            }\n          }}\n          value={params.tracklist}\n        />\n        <TwitterShareButton url={shortenUrl} title=\"This is how my mixtape looks\">\n          <TwitterIcon round={true} style={{ padding: '5px' }} />\n        </TwitterShareButton>\n\n        <FacebookShareButton url={shortenUrl} title=\"This is how my mixtape looks\">\n          <FacebookIcon round={true} style={{ padding: '5px' }} />\n        </FacebookShareButton>\n\n        <h3>{parsedTracklist && parsedTracklist.length > 1 && Object.keys(parsedTracklist[0].properties)[0]}</h3>\n        <Chart\n          options={{\n            chart: {\n              id: 'apexchart-example',\n            },\n            xaxis: {\n              categories: parsedTracklist.map(({ title }) => truncateTitle(title)),\n              name: 'Track',\n            },\n            yaxis: {\n              labels: {\n                formatter: function (val) {\n                  return Math.floor(val)\n                },\n              },\n            },\n          }}\n          series={[\n            {\n              name: 'Actual',\n              data: parsedTracklist.map(firstPropertyValue),\n            },\n          ]}\n          height=\"200\"\n        />\n        <h3>Keys</h3>\n        <Chart\n          options={{\n            chart: {\n              id: 'apexchart-example',\n            },\n            xaxis: {\n              categories: parsedTracklist.map(({ title }) => truncateTitle(title)),\n            },\n          }}\n          series={[\n            {\n              name: 'key',\n              data: parsedTracklist.map(R.prop('keyNumber')),\n            },\n          ]}\n          height=\"200\"\n        />\n      </Container>\n      <GithubCorner href=\"https://github.com/gadgetmies/mixtape_planner\" target=\"_blank\" />\n    </>\n  )\n}\nexport default Visualizer\n","import './App.css'\nimport React from 'react'\nimport { useUrlSearchParams } from 'use-url-search-params'\n\nimport Planner from './Planner'\nimport Visualizer from './Visualizer'\n\nfunction App() {\n  const [params] = useUrlSearchParams({ tracklist: undefined })\n  return !params.tracklist ? <Planner /> : <Visualizer tracklist={params.tracklist}/>\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","export const isSuitableKey = (t1, t2, useConservativeKeyTransitions = false) =>\n  Math.abs(t1.keyNumber - t2.keyNumber) % 11 <= 1 &&\n  (!useConservativeKeyTransitions || t1.isMinor === t2.isMinor || t1.keyNumber === t2.keyNumber)\n\nexport const findSuitableTracksByKey = (current, tracks, useConservativeKeyTransitions = false) => {\n  return tracks.filter((t) => isSuitableKey(current, t, useConservativeKeyTransitions))\n}\n\nexport const keyDistance = (useConservativeKeyTransitions) => (t1, t2) =>\n  Math.abs(t1.keyNumber - t2.keyNumber) + (useConservativeKeyTransitions && t1.isMinor !== t2.isMinor ? 1 : 0)\n\nexport const getKeyString = (keyNumber, isMinor) => `${keyNumber}${isMinor ? 'B' : 'A'}`\n","import * as R from 'ramda'\n\nexport const limits = values => ({\n  min: R.apply(Math.min, values),\n  max: R.apply(Math.max, values)\n})\n\nexport const normalize = (newMin, newMax, range = undefined) => values => {\n  const { min: oldMin, max: oldMax } = range || limits(values)\n  return values.map(oldValue => (((oldValue - oldMin) * (newMax - newMin)) / (oldMax - oldMin)) + newMin)\n}\n","export const penaltyFn = (ref, value) => Math.abs(ref - value)\nexport const saw = (riseTime) => (n) => {\n  const pos = n / riseTime\n  return pos - Math.floor(pos)\n}\nexport const raisingSaw = (riseTime, length) => (n) => (saw(riseTime)(n) + (n / length)) / 2\nexport const absoluteSine = (n) => Math.abs(Math.sin(n / 2))\nexport const normalizedSine = (n) => (Math.sin(n) + 1) / 2\n"],"sourceRoot":""}